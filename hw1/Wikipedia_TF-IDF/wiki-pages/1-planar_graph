In topological graph theory, a 1-planar graph is a graph that can be drawn in the Euclidean plane in such a way that each edge has at most one crossing point, where it crosses a single additional edge.

1-planar graphs were first studied by Ringel (1965), who showed that they can be colored with at most seven colors.[1] Later, the precise number of colors needed to color these graphs, in the worst case, was shown to be six.[2] The example of the complete graph K , which is 1-planar, shows that 1-planar graphs may sometimes require six colors. However, the proof that six colors are always enough is more complicated.

Ringel's motivation was in trying to solve a variation of total coloring for planar graphs, in which one simultaneously colors the vertices and faces of a planar graph in such a way that no two adjacent vertices have the same color, no two adjacent faces have the same color, and no vertex and face that are adjacent to each other have the same color. This can obviously be done using eight colors by applying the four color theorem to the given graph and its dual graph separately, using two disjoint sets of four colors. However, fewer colors may be obtained by forming an auxiliary graph that has a vertex for each vertex or face of the given planar graph, and in which two auxiliary graph vertices are adjacent whenever they correspond to adjacent features of the given planar graph. A vertex coloring of the auxiliary graph corresponds to a vertex-face coloring of the original planar graph. This auxiliary graph is 1-planar, from which it follows that Ringel's vertex-face coloring problem may also be solved with six colors.[2] The graph K cannot be formed as an auxiliary graph in this way, but nevertheless the vertex-face coloring problem also sometimes requires six colors; for instance, if the planar graph to be colored is a triangular prism, then its eleven vertices and faces require six colors, because no three of them may be given a single color.[3]

Every 1-planar graph with n vertices has at most 4n8 edges.[4] More strongly, each 1-planar drawing has at most n2 crossings; removing one edge from each crossing pair of edges leaves a planar graph, which can have at most 3n6 edges, from which the 4n8 bound on the number of edges in the original 1-planar graph immediately follows.[5] However, unlike planar graphs (for which all maximal planar graphs on a given vertex set have the same number of edges as each other), there exist maximal 1-planar graphs (graphs to which no additional edges can be added while preserving 1-planarity) that have significantly fewer than 4n8 edges.[6] The bound of 4n8 on the maximum possible number of edges in a 1-planar graph can be used to show that the complete graph K on seven vertices is not 1-planar, because this graph has 21 edges and in this case 4n8=20<21.[7]

A 1-planar graph is said to be an optimal 1-planar graph if it has exactly 4n8 edges, the maximum possible. In a 1-planar embedding of an optimal 1-planar graph, the uncrossed edges necessarily form a quadrangulation (a polyhedral graph in which every face is a quadrilateral). Every quadrangulation gives rise to an optimal 1-planar graph in this way, by adding the two diagonals to each of its quadrilateral faces. It follows that every optimal 1-planar graph is Eulerian (all of its vertices have even degree), that the minimum degree in such a graph is six, and that every optimal 1-planar graph has at least eight vertices of degree exactly six. Additionally, every optimal 1-planar graph is 4-vertex-connected, and every 4-vertex cut in such a graph is a separating cycle in the underlying quadrangulation.[8]

The graphs that have straight 1-planar drawings (that is, drawings in which each edge is represented by a line segment, and in which each line segment is crossed by at most one other edge) have a slightly tighter bound of 4n9 on the maximum number of edges, achieved by infinitely many graphs.[9]

A complete classification of the 1-planar complete graphs, complete bipartite graphs, and more generally complete multipartite graphs is known. Every complete bipartite graph of the form K is 1-planar, as is every complete tripartite graph of the form K . Other than these infinite sets of examples, the only complete multipartite 1-planar graphs are K , K , K , K , K , and their subgraphs. The minimal non-1-planar complete multipartite graphs are K , K , K , K , and K . For instance, the complete bipartite graph K is 1-planar because it is a subgraph of K , but K is not 1-planar.[7]

It is NP-complete to test whether a given graph is 1-planar,[10][11] and it remains NP-complete even for the graphs formed from planar graphs by adding a single edge[12] and for graphs of bounded bandwidth.[13] The problem is fixed-parameter tractable when parameterized by cyclomatic number or by tree-depth, so it may be solved in polynomial time when those parameters are bounded.[13]

In contrast to Fry's theorem for planar graphs, not every 1-planar graph may be drawn 1-planarly with straight line segments for its edges.[14][15] However, testing whether a 1-planar drawing may be straightened in this way can be done in polynomial time.[16] Additionally, every 3-vertex-connected 1-planar graph has a 1-planar drawing in which at most one edge, on the outer face of the drawing, has a bend in it. This drawing can be constructed in linear time from a 1-planar embedding of the graph.[17] The 1-planar graphs have bounded book thickness,[18] but some 1-planar graphs including K have book thickness at least four.[19]

1-planar graphs have bounded local treewidth, meaning that there is a (linear) function f such that the 1-planar graphs of diameter d have treewidth at most f(d); the same property holds more generally for the graphs that can be embedded onto a surface of bounded genus with a bounded number of crossings per edge. They also have separators, small sets of vertices the removal of which decomposes the graph into connected components whose size is a constant fraction of the size of the whole graph. Based on these properties, numerous algorithms for planar graphs, such as Baker's technique for designing approximation algorithms, can be extended to 1-planar graphs. For instance, this method leads to a polynomial-time approximation scheme for the maximum independent set of a 1-planar graph.[20]

The class of graphs analogous to outerplanar graphs for 1-planarity are called the outer-1-planar graphs. These are graphs that can be drawn in a disk, with the vertices on the boundary of the disk, and with at most one crossing per edge. These graphs can always be drawn (in an outer-1-planar way) with straight edges and right angle crossings.[21] By using dynamic programming on the SPQR tree of a given graph, it is possible to test whether it is outer-1-planar in linear time.[22][23] The triconnected components of the graph (nodes of the SPQR tree) can consist only of cycle graphs, bond graphs, and four-vertex complete graphs, from which it also follows that outer-1-planar graphs are planar and have treewidth at most three. Unlike 1-planar graphs, the outer-1-planar graphs have a characterization in terms of graph minors: a graph is outer-1-planar if and only if it avoids each of a set of five forbidden minors.[23]

1-planar graphs have been generalized to k-planar graphs, graphs for which each edge is crossed at most k times. Ringel defined the local crossing number of G to be the least non-negative integer k such that G has a k-planar drawing; geometric thickness is at most one more than local crossing number.[24] The k-planar graphs with n vertices have at most O(k1/2n) edges,[25] and treewidth O((kn)1/2).[26] A shallow minor of a k-planar graph, with depth d, is itself a (2d+1)k-planar graph, so the shallow minors of 1-planar graphs and of k-planar graphs are also sparse graphs, implying that the 1-planar and k-planar graphs have bounded expansion.[27]

Nonplanar graphs may also be parameterized by their crossing number, the minimum number of pairs of edges that cross in any drawing of the graph. A graph with crossing number k is necessarily k-planar, but not necessarily vice versa. For instance, the Heawood graph has crossing number 3, but it is not necessary for its three crossings to all occur on the same edge of the graph, so it is 1-planar, and can in fact be drawn in a way that simultaneously optimizes the total number of crossings and the crossings per edge.

Another related concept for nonplanar graphs is graph skewness, the minimal number of edges that must be removed to make a graph planar.